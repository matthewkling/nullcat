[{"path":"https://matthewkling.github.io/nullcat/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 nullcat authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://matthewkling.github.io/nullcat/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Matthew Kling. Maintainer.","code":""},{"path":"https://matthewkling.github.io/nullcat/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Kling M (2025). nullcat: Null models categorical continuous community matrices. R package version 0.1.0, https://github.com/matthewkling/nullcat.","code":"@Manual{,   title = {nullcat: Null models for categorical and continuous community matrices},   author = {Matthew Kling},   year = {2025},   note = {R package version 0.1.0},   url = {https://github.com/matthewkling/nullcat}, }"},{"path":"https://matthewkling.github.io/nullcat/index.html","id":"nullcat-","dir":"","previous_headings":"","what":"Null models for categorical and continuous community matrices","title":"Null models for categorical and continuous community matrices","text":"nullcat provides novel null model algorithms categorical quantitative community ecology data. extends classic binary null models (e.g., curveball, swap) work categorical data, introduces stratified randomization framework continuous data addresses limitations existing quantitative null model methods.","code":""},{"path":"https://matthewkling.github.io/nullcat/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Null models for categorical and continuous community matrices","text":"package currently development. Install GitHub:","code":"# install.packages(\"remotes\") remotes::install_github(\"matthewkling/nullcat\")"},{"path":[]},{"path":"https://matthewkling.github.io/nullcat/index.html","id":"id_1-categorical-null-models","dir":"","previous_headings":"Key Features","what":"1. Categorical Null Models","title":"Null models for categorical and continuous community matrices","text":"nullcat generalizes binary null model algorithms handle categorical data (site--species matrices integers representing discrete strata categories): curvecat: Categorical curveball algorithm swapcat: Categorical 2x2 swap algorithm tswapcat: Categorical trial-swap algorithm r0cat: Row-constrained randomization (fixed row margins) c0cat: Column-constrained randomization (fixed column margins) algorithms preserve multiset categories fixed margins (rows /columns) randomizing spatial arrangement.","code":""},{"path":"https://matthewkling.github.io/nullcat/index.html","id":"id_2-stratified-quantitative-null-models","dir":"","previous_headings":"Key Features","what":"2. Stratified Quantitative Null Models","title":"Null models for categorical and continuous community matrices","text":"quantize() function provides principled approach randomizing quantitative community data (abundance, biomass, cover, SDM probabilities): Stratify: Convert continuous values discrete strata Randomize: Apply categorical null model stratified matrix Reassign: Map randomized strata back original quantitative values approach offers greater control transparency compared existing quantitative null model methods, flexible options : Number definition strata Value transformations (log, sqrt, rank, etc.) Preservation levels (cell, stratum, row, column) Multiple randomization algorithms","code":""},{"path":"https://matthewkling.github.io/nullcat/index.html","id":"id_3-diagnostic--utility-functions","dir":"","previous_headings":"Key Features","what":"3. Diagnostic & Utility Functions","title":"Null models for categorical and continuous community matrices","text":"trace_cat(): Trace mixing diagnostics MCMC convergence suggest_n_iter(): Automatically suggest burn-iterations quantize_prep(): Pre-compute overhead efficient repeated randomization quantize_null(): Generate null distributions optional parallelization commsim_cat() & commsim_cat_seq(): Integration vegan null model workflows core algorithms implemented C++ via Rcpp computational efficiency.","code":""},{"path":[]},{"path":"https://matthewkling.github.io/nullcat/index.html","id":"categorical-data","dir":"","previous_headings":"Quick Start","what":"Categorical Data","title":"Null models for categorical and continuous community matrices","text":"","code":"library(nullcat)  # Create a categorical matrix (e.g., strata or discrete abundance classes) set.seed(123) cat_matrix <- matrix(sample(1:4, 20*10, replace = TRUE), nrow = 20)  # Randomize using curvecat (preserves row & column category multisets) randomized <- curvecat(cat_matrix, n_iter = 1000)  # Compare margins all.equal(sort(cat_matrix[1,]), sort(randomized[1,]))  # Row preserved #> [1] TRUE all.equal(sort(cat_matrix[,1]), sort(randomized[,1]))  # Column preserved #> [1] TRUE"},{"path":"https://matthewkling.github.io/nullcat/index.html","id":"quantitative-data","dir":"","previous_headings":"Quick Start","what":"Quantitative Data","title":"Null models for categorical and continuous community matrices","text":"","code":"# Create a quantitative community matrix set.seed(456) comm <- matrix(rexp(50 * 30, rate = 0.5), nrow = 50,                dimnames = list(paste0(\"site\", 1:50),                                paste0(\"sp\", 1:30)))  # Default: curvecat-backed stratified randomization rand1 <- quantize(comm, n_strata = 5, n_iter = 2000)  # Preserve row value multisets rand2 <- quantize(comm, n_strata = 5, fixed = \"row\", n_iter = 2000)  # Check row sums are preserved when fixed = \"row\" all.equal(rowSums(comm), rowSums(rand2)) #> [1] TRUE"},{"path":"https://matthewkling.github.io/nullcat/index.html","id":"trace-diagnostics","dir":"","previous_headings":"Quick Start","what":"Trace Diagnostics","title":"Null models for categorical and continuous community matrices","text":"","code":"# Assess mixing behavior set.seed(789) x <- matrix(sample(1:5, 2000, replace = TRUE), 40)  trace <- trace_cat(x, fun = \"nullcat\", method = \"curvecat\",                    n_iter = 1000, n_chains = 5, thin = 10) plot(trace) # Get burn-in recommendation suggested <- suggest_n_iter(trace, tail_frac = 0.3) print(suggested) #> suggested_n_iter object #> ─────────────────────── #> Converged: TRUE  #> Suggested n iterations: 260"},{"path":"https://matthewkling.github.io/nullcat/index.html","id":"efficient-repeated-randomization","dir":"","previous_headings":"Quick Start","what":"Efficient Repeated Randomization","title":"Null models for categorical and continuous community matrices","text":"","code":"# Generate null distribution of randomized matrices set.seed(101) comm <- matrix(rexp(30 * 20), nrow = 30) null_dist <- quantize_null(comm, n_reps = 999,                             n_strata = 4, fixed = \"row\",                            n_cores = 5)  # Set n_cores > 1 for parallelization"},{"path":"https://matthewkling.github.io/nullcat/index.html","id":"integration-with-vegan","dir":"","previous_headings":"","what":"Integration with vegan","title":"Null models for categorical and continuous community matrices","text":"","code":"library(vegan)  # Create commsim object for categorical data cs <- commsim_cat_seq(method = \"curvecat\")  # Use with vegan's nullmodel framework nm <- nullmodel(cat_matrix, method = cs) sims <- simulate(nm, nsim = 99, burnin = 1000, thin = 100)"},{"path":"https://matthewkling.github.io/nullcat/index.html","id":"related-packages","dir":"","previous_headings":"","what":"Related Packages","title":"Null models for categorical and continuous community matrices","text":"vegan: Classic null models binary community matrices picante: Phylogenetic trait-based null models EcoSimR: Suite null model algorithms nullcat complements packages extending null model capabilities categorical stratified quantitative data. Development Status: package active development. API may change initial CRAN release. Feedback contributions welcome.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/c0cat.html","id":null,"dir":"Reference","previous_headings":"","what":"Column-constrained categorical randomization (c0cat) — c0cat","title":"Column-constrained categorical randomization (c0cat) — c0cat","text":"`r0cat()` preserves multiset categories within column randomizes positions across rows, leaving row margins free. categorical analog vegan's `c0` algorithm. non-sequential method.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/c0cat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Column-constrained categorical randomization (c0cat) — c0cat","text":"","code":"c0cat(x, n_iter = 1L, output = c(\"category\", \"index\"), seed = NULL)"},{"path":"https://matthewkling.github.io/nullcat/reference/c0cat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Column-constrained categorical randomization (c0cat) — c0cat","text":"x matrix categorical data, encoded integers. Values represent category stratum membership cell. n_iter Number iterations. Default 1000. Larger values yield thorough mixing. Ignored non-sequential methods. Minimum burn-times can estimated suggest_n_iter. output Character indicating type result return: \"category\" (default) returns randomized matrix \"index\" returns index matrix describing original        entries moved. seed Integer used seed random number generator, reproducibility.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/c0cat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Column-constrained categorical randomization (c0cat) — c0cat","text":"matrix dimensions x, either randomized   categorical values (output = \"category\") integer index   matrix describing permutation entries (output = \"index\").","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/commsim_cat.html","id":null,"dir":"Reference","previous_headings":"","what":"Categorical nullcat commsim (non-sequential) — commsim_cat","title":"Categorical nullcat commsim (non-sequential) — commsim_cat","text":"Construct vegan::commsim object uses nullcat() non-sequential null model categorical / integer matrices. simulated matrix generated independently applying nullcat() n_iter trades starting original matrix.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/commsim_cat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Categorical nullcat commsim (non-sequential) — commsim_cat","text":"","code":"commsim_cat(   n_iter = 10000,   method = nullcat_methods(),   output = c(\"category\", \"index\") )"},{"path":"https://matthewkling.github.io/nullcat/reference/commsim_cat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Categorical nullcat commsim (non-sequential) — commsim_cat","text":"n_iter Integer, number iterations per simulated matrix. method Character specifying nullcat randomization algorithm use. See nullcat() details. output Character, passed nullcat(output = ...). Typically \"category\" (default) \"index\".","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/commsim_cat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Categorical nullcat commsim (non-sequential) — commsim_cat","text":"object class \"commsim\" suitable   vegan::nullmodel().","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/commsim_cat_seq.html","id":null,"dir":"Reference","previous_headings":"","what":"Categorical curveball commsim (sequential / Markov chain) — commsim_cat_seq","title":"Categorical curveball commsim (sequential / Markov chain) — commsim_cat_seq","text":"Construct vegan::commsim object uses nullcat() *sequential* null model: successive simulated matrices form Markov chain, mixing controlled via thin burnin arguments simulate.nullmodel().","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/commsim_cat_seq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Categorical curveball commsim (sequential / Markov chain) — commsim_cat_seq","text":"","code":"commsim_cat_seq(method = nullcat_methods(), output = c(\"category\", \"index\"))"},{"path":"https://matthewkling.github.io/nullcat/reference/commsim_cat_seq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Categorical curveball commsim (sequential / Markov chain) — commsim_cat_seq","text":"method Character specifying nullcat randomization algorithm use. See nullcat() details. output Character, passed nullcat(output = ...). Typically \"category\" (default) \"index\".","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/commsim_cat_seq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Categorical curveball commsim (sequential / Markov chain) — commsim_cat_seq","text":"object class \"commsim\" suitable   vegan::nullmodel().","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/commsim_cat_seq.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Categorical curveball commsim (sequential / Markov chain) — commsim_cat_seq","text":"Internally, simulation \"step\" advances chain thin curvecat trades.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/curvecat.html","id":null,"dir":"Reference","previous_headings":"","what":"Categorical curveball randomization (curvecat) — curvecat","title":"Categorical curveball randomization (curvecat) — curvecat","text":"Categorical generalization binary curveball algorithm (Strona et al.) matrices categorical data. function convenience wrapper around [nullcat()] `method = \"curvecat\"`.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/curvecat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Categorical curveball randomization (curvecat) — curvecat","text":"","code":"curvecat(x, n_iter = 1000L, output = c(\"category\", \"index\"), seed = NULL)"},{"path":"https://matthewkling.github.io/nullcat/reference/curvecat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Categorical curveball randomization (curvecat) — curvecat","text":"x matrix categorical data, encoded integers. Values represent category stratum membership cell. n_iter Number iterations. Default 1000. Larger values yield thorough mixing. Ignored non-sequential methods. Minimum burn-times can estimated suggest_n_iter. output Character indicating type result return: \"category\" (default) returns randomized matrix \"index\" returns index matrix describing original        entries moved. seed Integer used seed random number generator, reproducibility.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/curvecat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Categorical curveball randomization (curvecat) — curvecat","text":"matrix dimensions x, either randomized   categorical values (output = \"category\") integer index   matrix describing permutation entries (output = \"index\").","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/curvecat.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Categorical curveball randomization (curvecat) — curvecat","text":"curvecat algorithm operates pairs rows time, grouping differing entries unordered category pairs redistributing orientation pairs preserving multiset categories within row. two categories, `curvecat()` reduces behavior original binary curveball algorithm applied 0/1 matrix.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/curvecat.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Categorical curveball randomization (curvecat) — curvecat","text":"Strona, G., Nappo, D., Boccacci, F., Fattorini, S., & San-Miguel-Ayanz, J. (2014). fast unbiased procedure randomize ecological binary matrices fixed row column totals. Nature Communications, 5, 4114.","code":""},{"path":[]},{"path":"https://matthewkling.github.io/nullcat/reference/kappa.html","id":null,"dir":"Reference","previous_headings":"","what":"Cohen's kappa for categorical data — kappa","title":"Cohen's kappa for categorical data — kappa","text":"Computes Cohen's kappa two categorical matrices, treating cell paired categorical observation.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/kappa.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cohen's kappa for categorical data — kappa","text":"","code":"kappa(a, b)"},{"path":"https://matthewkling.github.io/nullcat/reference/kappa.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cohen's kappa for categorical data — kappa","text":", b Matrices arrays dimensions categorical entries.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/nullcat.html","id":null,"dir":"Reference","previous_headings":"","what":"Categorical matrix randomization — nullcat","title":"Categorical matrix randomization — nullcat","text":"Categorical generalizations binary community null model algorithms.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/nullcat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Categorical matrix randomization — nullcat","text":"","code":"nullcat(   x,   method = nullcat_methods(),   n_iter = 1000L,   output = c(\"category\", \"index\"),   seed = NULL )"},{"path":"https://matthewkling.github.io/nullcat/reference/nullcat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Categorical matrix randomization — nullcat","text":"x matrix categorical data, encoded integers. Values represent category stratum membership cell. method Character specifying randomization algorithm use. Options include: \"curvecat\": categorical analog `curveball`;        see curvecat details. \"swapcat\": categorical analog `swap`;        see swapcat details. \"tswapcat\": categorical analog `tswap`;        see tswapcat details. \"r0cat\": categorical analog `r0`;        see r0cat details. \"c0cat\": categorical analog `c0`;        see c0cat details. n_iter Number iterations. Default 1000. Larger values yield thorough mixing. Ignored non-sequential methods. Minimum burn-times can estimated suggest_n_iter. output Character indicating type result return: \"category\" (default) returns randomized matrix \"index\" returns index matrix describing original        entries moved. seed Integer used seed random number generator, reproducibility.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/nullcat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Categorical matrix randomization — nullcat","text":"matrix dimensions x, either randomized   categorical values (output = \"category\") integer index   matrix describing permutation entries (output = \"index\").","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/nullcat.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Categorical matrix randomization — nullcat","text":"Note categorical null models cell-level categorical data. Site-level attributes (e.g., land cover) species-level attributes (e.g., functional traits) analyzed using different approaches.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/nullcat_methods.html","id":null,"dir":"Reference","previous_headings":"","what":"Supported nullcat methods — nullcat_methods","title":"Supported nullcat methods — nullcat_methods","text":"Return character vector supported categorical randomization methods.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/nullcat_methods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Supported nullcat methods — nullcat_methods","text":"","code":"nullcat_methods()"},{"path":"https://matthewkling.github.io/nullcat/reference/nullcat_methods.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Supported nullcat methods — nullcat_methods","text":"character vector method names.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/quantize.html","id":null,"dir":"Reference","previous_headings":"","what":"Stratified randomization of a quantitative community matrix — quantize","title":"Stratified randomization of a quantitative community matrix — quantize","text":"quantize() community null model quantitative community data (e.g. abundance, biomass, occurrence probability). works converting quantitative values small number categorical strata, randomizing categorical layout chosen categorical null model, reassigning quantitative values within stratum.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/quantize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Stratified randomization of a quantitative community matrix — quantize","text":"","code":"quantize(   x = NULL,   prep = NULL,   method = nullcat_methods(),   fixed = c(\"cell\", \"stratum\", \"row\", \"col\"),   breaks = NULL,   n_strata = 5,   transform = identity,   offset = 0,   zero_stratum = FALSE,   n_iter = 1000 )"},{"path":"https://matthewkling.github.io/nullcat/reference/quantize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Stratified randomization of a quantitative community matrix — quantize","text":"x Community matrix sites rows, species columns, nonnegative quantitative values cells. Ignored prep supplied. prep Optional precomputed object returned quantize_prep. supplied, x ignored overhead (stratification, pools, etc.) taken prep, typically much faster generating many randomizations dataset. method Character string specifying null model algorithm. default \"curvecat\" uses categorical curveball algorithm. See nullcat alternative options. fixed Character string specifying level quantitative   values held fixed randomization. One : \"cell\" (default; available method = \"curvecat\"):       values remain attached original cells move       categorical randomization. Row column value       distributions preserved, mapping original       cell randomized destination fixed. \"stratum\": values shuffled globally within stratum,       holding overall stratum-level value distribution fixed. \"row\": values shuffled within strata separately       row, holding row’s value multiset fixed. compatible       methods. \"col\": values shuffled within strata separately       column, holding column’s value multiset fixed. Note interacts method: different null models fix different margins underlying binary representation. breaks Numeric vector stratum breakpoints. n_strata Integer giving number strata split data . Must 2 greater. Larger values yield randomizations less mixing higher fidelity original marginal distributions. Default 5. Ignored unless breaks = NULL. transform function used transform values x assigning n_strata equal-width intervals. Examples include sqrt, log, rank (equal-occupancy strata), etc.; default identity. zero_stratum = TRUE, transformation applied nonzero values. function pass NA values. argument ignored unless breaks = NULL. offset Numeric value -1 1 (default 0) indicating much shift stratum breakpoints relative binwidth (applied quantization : breaks <- breaks + offset * bw). assess sensitivity stratum boundaries, run quantize() multiple times different offset values. Ignored unless breaks = NULL. zero_stratum Logical indicating whether segregate zeros stratum. FALSE (default), zeros likely combined stratum also includes small positive numbers. breaks specified, zero simply gets added additional break; , one n_strata represent zeros others nonzero ranges. n_iter Number iterations. Default 1000. Larger values yield thorough mixing. Ignored non-sequential methods. Minimum burn-times can estimated suggest_n_iter.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/quantize.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Stratified randomization of a quantitative community matrix — quantize","text":"randomized version x, dimensions   dimnames. method = \"curvecat\", quantitative values   reassigned within strata preserving row column stratum   multisets. binary methods, result corresponds applying   chosen binary null model stratum recombining.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/quantize.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Stratified randomization of a quantitative community matrix — quantize","text":"default, quantize() compute necessary overhead given dataset (strata, pools, etc.) internally. repeated randomization matrix (e.g. build null distribution), overhead can computed using quantize_prep reused supplying resulting object via prep argument.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/quantize.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Stratified randomization of a quantitative community matrix — quantize","text":"","code":"# \\donttest{ # toy quantitative community matrix set.seed(1) comm <- matrix(rexp(50 * 40), nrow = 50,                dimnames = list(paste0(\"site\", 1:50),                                paste0(\"sp\", 1:40)))  # default: curvecat-backed stratified randomization rand1 <- quantize(comm)  # change stratification and preservation mode rand2 <- quantize(comm, n_strata = 4,                   transform = sqrt,                   fixed  = \"row\",                   n_iter    = 2000)  # use a different randomization algorithm rand3 <- quantize(comm, method = \"swapcat\", n_iter = 10000)  # precompute overhead and reuse for many randomizations prep  <- quantize_prep(comm, method = \"curvecat\",                        n_strata = 5, fixed = \"row\") rand4 <- quantize(prep = prep) rand5 <- quantize(prep = prep) # }"},{"path":"https://matthewkling.github.io/nullcat/reference/quantize_null.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a null distribution using quantize() — quantize_null","title":"Generate a null distribution using quantize() — quantize_null","text":"Generate null distribution using quantize()","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/quantize_null.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a null distribution using quantize() — quantize_null","text":"","code":"quantize_null(x, n_reps = 999L, stat = NULL, n_cores = 1L, ...)"},{"path":"https://matthewkling.github.io/nullcat/reference/quantize_null.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a null distribution using quantize() — quantize_null","text":"x Community matrix (species × sites, numeric matrix). n_reps Number randomizations generate. Default `999`. stat Optional summary function taking matrix returning numeric statistic (e.g. `rowSums` abundance data give total abundance per site). `NULL` (default), function returns full set randomized matrices. n_cores Number compute cores use parallel processing. Default `1`. ... Additional arguments passed `quantize()` (e.g. `method`, `breaks`, `n_strata`, `transform`, `offset`, `zero_stratum`, `fixed`, `n_iter`, etc.).","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/quantize_null.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a null distribution using quantize() — quantize_null","text":"stat NULL: 3D array (rows × cols × n_reps).   stat NULL: numeric array statistic values   (dimensionality depend stat).","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/quantize_prep.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare stratified null model overhead for quantize() — quantize_prep","title":"Prepare stratified null model overhead for quantize() — quantize_prep","text":"quantize_prep() precomputes stratification bookkeeping needed quantize() given quantitative community matrix. useful want generate many randomizations dataset: expensive steps (strata assignment, value pools, arguments underlying null model) computed , resulting object can passed quantize(prep = ...) fast repeated draws.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/quantize_prep.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare stratified null model overhead for quantize() — quantize_prep","text":"","code":"quantize_prep(   x,   method = nullcat_methods(),   fixed = c(\"cell\", \"stratum\", \"row\", \"col\"),   breaks = NULL,   n_strata = 5,   transform = identity,   offset = 0,   zero_stratum = FALSE,   n_iter = 1000 )"},{"path":"https://matthewkling.github.io/nullcat/reference/quantize_prep.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare stratified null model overhead for quantize() — quantize_prep","text":"x Community matrix sites rows, species columns, nonnegative quantitative values cells. dataset stratification null model overhead prepared. method Character string specifying null model algorithm. default \"curvecat\" uses categorical curveball algorithm. See nullcat alternative options. fixed Character string specifying level quantitative   values held fixed randomization. One : \"cell\" (default; available method = \"curvecat\"):       values remain attached original cells move       categorical randomization. Row column value       distributions preserved, mapping original       cell randomized destination fixed. \"stratum\": values shuffled globally within stratum,       holding overall stratum-level value distribution fixed. \"row\": values shuffled within strata separately       row, holding row’s value multiset fixed. compatible       methods. \"col\": values shuffled within strata separately       column, holding column’s value multiset fixed. Note interacts method: different null models fix different margins underlying binary representation. breaks Numeric vector stratum breakpoints. n_strata Integer giving number strata split data . Must 2 greater. Larger values yield randomizations less mixing higher fidelity original marginal distributions. Default 5. Ignored unless breaks = NULL. transform function used transform values x assigning n_strata equal-width intervals. Examples include sqrt, log, rank (equal-occupancy strata), etc.; default identity. zero_stratum = TRUE, transformation applied nonzero values. function pass NA values. argument ignored unless breaks = NULL. offset Numeric value -1 1 (default 0) indicating much shift stratum breakpoints relative binwidth (applied quantization : breaks <- breaks + offset * bw). assess sensitivity stratum boundaries, run quantize() multiple times different offset values. Ignored unless breaks = NULL. zero_stratum Logical indicating whether segregate zeros stratum. FALSE (default), zeros likely combined stratum also includes small positive numbers. breaks specified, zero simply gets added additional break; , one n_strata represent zeros others nonzero ranges. n_iter Number iterations. Default 1000. Larger values yield thorough mixing. Ignored non-sequential methods. Minimum burn-times can estimated suggest_n_iter.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/quantize_prep.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare stratified null model overhead for quantize() — quantize_prep","text":"list class \"quantize_prep\" (want set )   containing components needed quantize(): x: original quantitative marix x, strata: integer matrix dimension x,       giving stratum index (1, ..., n_strata) cell. stratarray: binary methods, 3D array dimension       n_strata × nrow(x) × ncol(x) containing       binary incidence matrix stratum; NULL       method = \"curvecat\". pool: data structure encoding quantitative value pools       used reassignment. \"curvecat\", list       per-stratum per-row/column pools depending fixed;       binary methods, matrix pre-shuffled values. method: null model method used (      method argument). n_strata, transform, offset, fixed:       stratification reassignment settings used construct       strata pool. sim_args: named list arguments passed       simulate.nullmodel (binary methods) used       internally curvecat (e.g. n_iter). object intended passed unchanged quantize()   via prep argument.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/quantize_prep.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prepare stratified null model overhead for quantize() — quantize_prep","text":"Internally, quantize_prep(): transforms stratifies x n_strata numeric     intervals (via stratify()), constructs appropriate value pools given fixed     (either categorical \"curvecat\" backend binary     vegan methods), assembles arguments underlying null model call     (curvecat simulate.nullmodel). returned object can reused across calls quantize(), quantize_null(), helpers accept prep argument.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/quantize_prep.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare stratified null model overhead for quantize() — quantize_prep","text":"","code":"# \\donttest{ set.seed(1) comm <- matrix(rexp(50 * 40), nrow = 50,                dimnames = list(paste0(\"site\", 1:50),                                paste0(\"sp\", 1:40)))  # prepare overhead for a curvecat-backed stratified null model prep <- quantize_prep(comm, method = \"curvecat\",                       n_strata = 5,                       fixed = \"row\",                       n_iter = 2000)  # fast repeated randomizations using the same prep rand1 <- quantize(prep = prep) rand2 <- quantize(prep = prep)  # use a binary vegan method on each stratum prep_bin <- quantize_prep(comm, method = \"swap\",                           n_strata = 4,                           burnin = 10000) #> Error in quantize_prep(comm, method = \"swap\", n_strata = 4, burnin = 10000): unused argument (burnin = 10000) rand3 <- quantize(prep = prep_bin) #> Error: object 'prep_bin' not found # }"},{"path":"https://matthewkling.github.io/nullcat/reference/r0cat.html","id":null,"dir":"Reference","previous_headings":"","what":"Row-constrained categorical randomization (r0cat) — r0cat","title":"Row-constrained categorical randomization (r0cat) — r0cat","text":"`r0cat()` preserves multiset categories within row randomizes positions across columns, leaving column margins free. categorical analog vegan's `r0` algorithm. non-sequential method.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/r0cat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Row-constrained categorical randomization (r0cat) — r0cat","text":"","code":"r0cat(x, n_iter = 1L, output = c(\"category\", \"index\"), seed = NULL)"},{"path":"https://matthewkling.github.io/nullcat/reference/r0cat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Row-constrained categorical randomization (r0cat) — r0cat","text":"x matrix categorical data, encoded integers. Values represent category stratum membership cell. n_iter Number iterations. Default 1000. Larger values yield thorough mixing. Ignored non-sequential methods. Minimum burn-times can estimated suggest_n_iter. output Character indicating type result return: \"category\" (default) returns randomized matrix \"index\" returns index matrix describing original        entries moved. seed Integer used seed random number generator, reproducibility.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/r0cat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Row-constrained categorical randomization (r0cat) — r0cat","text":"matrix dimensions x, either randomized   categorical values (output = \"category\") integer index   matrix describing permutation entries (output = \"index\").","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/stratify.html","id":null,"dir":"Reference","previous_headings":"","what":"Bin quantitative data into strata — stratify","title":"Bin quantitative data into strata — stratify","text":"Bin quantitative data strata","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/stratify.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bin quantitative data into strata — stratify","text":"","code":"stratify(   x,   breaks = NULL,   n_strata = 5,   transform = identity,   offset = 0,   zero_stratum = FALSE )"},{"path":"https://matthewkling.github.io/nullcat/reference/stratify.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bin quantitative data into strata — stratify","text":"x matrix vector containing non-negative values. breaks Numeric vector stratum breakpoints. n_strata Integer giving number strata split data . Must 2 greater. Larger values yield randomizations less mixing higher fidelity original marginal distributions. Default 5. Ignored unless breaks = NULL. transform function used transform values x assigning n_strata equal-width intervals. Examples include sqrt, log, rank (equal-occupancy strata), etc.; default identity. zero_stratum = TRUE, transformation applied nonzero values. function pass NA values. argument ignored unless breaks = NULL. offset Numeric value -1 1 (default 0) indicating much shift stratum breakpoints relative binwidth (applied quantization : breaks <- breaks + offset * bw). assess sensitivity stratum boundaries, run quantize() multiple times different offset values. Ignored unless breaks = NULL. zero_stratum Logical indicating whether segregate zeros stratum. FALSE (default), zeros likely combined stratum also includes small positive numbers. breaks specified, zero simply gets added additional break; , one n_strata represent zeros others nonzero ranges.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/stratify.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bin quantitative data into strata — stratify","text":"object size x, integer values representing   stratum classifications.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/suggest_n_iter.html","id":null,"dir":"Reference","previous_headings":"","what":"Suggest a reasonable n_iter for a randomization — suggest_n_iter","title":"Suggest a reasonable n_iter for a randomization — suggest_n_iter","text":"Uses trace diagnostics estimate many burn-iterations needed `nullcat` `quantize` randomization reach apparent stationary distribution, given dataset randomization method. Uses \"first pre-tail sign-crossing\" rule per chain, returns maximum across chains. Can called community matrix `cat_trace` object.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/suggest_n_iter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Suggest a reasonable n_iter for a randomization — suggest_n_iter","text":"","code":"suggest_n_iter(trace = NULL, tail_frac = 0.3, plot = FALSE, ...)"},{"path":"https://matthewkling.github.io/nullcat/reference/suggest_n_iter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Suggest a reasonable n_iter for a randomization — suggest_n_iter","text":"trace Either cat_trace object (returned trace_cat()), NULL. NULL, arguments trace_cat(), including x relevant parameters must supplied via ... tail_frac Fraction trace (end) used tail window (default 0.3). plot TRUE, plot trace, vertical line suggested value. ... Arguments passed trace_cat() including  arguments passes nullcat() quantize() function. Ignored trace non-NULL.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/suggest_n_iter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Suggest a reasonable n_iter for a randomization — suggest_n_iter","text":"integer class \"nullcat_n_iter\" attributes: n_iter (numeric NA), trace (matrix), steps (vector), tail_mean (per-chain), per_chain (data.frame), converged (logical).","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/suggest_n_iter.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Suggest a reasonable n_iter for a randomization — suggest_n_iter","text":"function uses “first pre-tail sign-crossing” heuristic identify burn-cutoff. simple variant standard mean-stability tests used MCMC convergence diagnostics (e.g., Heidelberger & Welch 1983; Geweke 1992; Geyer 1992). computes long-run mean based \"tail window\" chain, detects first iteration trace statistic crosses long-run mean, indicating chain begun oscillate around stationary value. chain reach long-run mean start tail window, chain determined reached stationarity, function returns NA attribute converged = FALSE.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/suggest_n_iter.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Suggest a reasonable n_iter for a randomization — suggest_n_iter","text":"Heidelberger, P. & Welch, P.D. (1983). Simulation run length control presence initial transient. Operations Research, 31(6): 1109–1144. Geweke, J. (1992). Evaluating accuracy sampling-based approaches calculation posterior moments. Bayesian Statistics 4, pp. 169–193. Geyer, C.J. (1992). Practical Markov Chain Monte Carlo. Statistical Science, 7(4): 473–483. Feller, W. (1968). Introduction Probability Theory Applications, Vol. . Wiley.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/suggest_n_iter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Suggest a reasonable n_iter for a randomization — suggest_n_iter","text":"","code":"set.seed(1234) x <- matrix(sample(1:5, 2500, replace = T), 50)  # call `trace_cat`, then pass result to `suggest_n_iter`: trace <- trace_cat(x = x, fun = \"nullcat\", n_iter = 1000,                      n_chains = 5, method = \"curvecat\") suggest_n_iter(trace, tail_frac = 0.3, plot = TRUE)  #> suggested_n_iter object #> ─────────────────────── #> Converged: TRUE  #> Suggested n iterations: 420   # alternatively, supply `trace_cat` arguments directly to `suggest_n_iter`: x <- matrix(runif(2500), 50) n_iter <- suggest_n_iter(     x = x, n_chains = 5, n_iter = 1000, tail_frac = 0.3,     fun = \"quantize\", n_strata = 4, fixed = \"stratum\",     method = \"curvecat\", plot = T)"},{"path":"https://matthewkling.github.io/nullcat/reference/swapcat.html","id":null,"dir":"Reference","previous_headings":"","what":"Categorical swap randomization (swapcat) — swapcat","title":"Categorical swap randomization (swapcat) — swapcat","text":"Categorical generalization binary 2x2 swap algorithm matrices categorical data. function convenience wrapper around [nullcat()] `method = \"swapcat\"`.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/swapcat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Categorical swap randomization (swapcat) — swapcat","text":"","code":"swapcat(x, n_iter = 1000L, output = c(\"category\", \"index\"), seed = NULL)"},{"path":"https://matthewkling.github.io/nullcat/reference/swapcat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Categorical swap randomization (swapcat) — swapcat","text":"x matrix categorical data, encoded integers. Values represent category stratum membership cell. n_iter Number iterations. Default 1000. Larger values yield thorough mixing. Ignored non-sequential methods. Minimum burn-times can estimated suggest_n_iter. output Character indicating type result return: \"category\" (default) returns randomized matrix \"index\" returns index matrix describing original        entries moved. seed Integer used seed random number generator, reproducibility.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/swapcat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Categorical swap randomization (swapcat) — swapcat","text":"matrix dimensions x, either randomized   categorical values (output = \"category\") integer index   matrix describing permutation entries (output = \"index\").","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/swapcat.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Categorical swap randomization (swapcat) — swapcat","text":"swapcat algorithm attempts random 2x2 swaps form $$ \\begin{pmatrix} & b \\\\ b & \\end{pmatrix} \\leftrightarrow \\begin{pmatrix} b & \\\\ & b \\end{pmatrix} $$ \\(\\) \\(b\\) distinct categories. swaps preserve multiset categories row column. two categories present, `swapcat()` reduces behavior standard binary swap algorithm.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/swapcat.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Categorical swap randomization (swapcat) — swapcat","text":"Gotelli, N. J. (2000). Null model analysis species co-occurrence patterns. *Ecology*, 81(9), 2606–2621. See also Gotelli & Entsminger (2003) *EcoSim: Null models software ecology* (Version 7.0) implementation details binary swap algorithm.","code":""},{"path":[]},{"path":"https://matthewkling.github.io/nullcat/reference/trace_cat.html","id":null,"dir":"Reference","previous_headings":"","what":"Trace diagnostics for categorical randomizations — trace_cat","title":"Trace diagnostics for categorical randomizations — trace_cat","text":"Applies nullcat() quantize() community matrix, recording summary statistic iteration help assess mixing given dataset.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/trace_cat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Trace diagnostics for categorical randomizations — trace_cat","text":"","code":"trace_cat(   x,   fun = c(\"nullcat\", \"quantize\"),   n_iter = 1000L,   thin = NULL,   n_chains = 5L,   n_cores = 1L,   stat = NULL,   seed = NULL,   plot = FALSE,   ... )"},{"path":"https://matthewkling.github.io/nullcat/reference/trace_cat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Trace diagnostics for categorical randomizations — trace_cat","text":"x Matrix categorical data (integers) quantitative values. fun function trace: \"nullcat\" \"quantize\". n_iter Total number update iterations simulate. Default 1000. thin Thinning interval (updates per recorded point). Default ~ n_iter/100. Smaller values increase resolution increase run time. n_chains Number independent chains run, assess consistency (default 5). n_cores Parallel chains (default 1). stat Function compares x permuted x_rand quantify similarity. Either function f(x, x_rand) returning scalar, NULL. NULL (default), traces use Cohen's kappa nullcat Pearson's correlation quantize. seed Optional integer seed reproducible traces. plot TRUE, plot traces. ... Arguments chosen fun (nullcat() quantize_null()), method, n_strata, fixed, etc.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/trace_cat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Trace diagnostics for categorical randomizations — trace_cat","text":"object class \"cat_trace\" elements: traces: matrix size (n_steps+1) x n_chains, including iteration 0 steps: integer vector iteration numbers (starting 0) fun, n_iter, thin, n_chains, n_cores, stat_name, call fun_args: list ... used (reproducibility) Plotting available via plot(cat_trace).","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/trace_cat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Trace diagnostics for categorical randomizations — trace_cat","text":"","code":"# nullcat trace set.seed(123) x <- matrix(sample(1:5, 2500, replace = T), 50) tr <- trace_cat(x, n_iter = 1000, n_chains = 5, fun = \"nullcat\",                 method = \"curvecat\") plot(tr)   # quantize trace x <- matrix(runif(2500), 50) tr <- trace_cat(x, n_iter = 1000, n_chains = 5, fun = \"quantize\",                 method = \"curvecat\", n_strata = 3, fixed = \"cell\") plot(tr)"},{"path":"https://matthewkling.github.io/nullcat/reference/tswapcat.html","id":null,"dir":"Reference","previous_headings":"","what":"Trial-swap categorical randomization (tswapcat) — tswapcat","title":"Trial-swap categorical randomization (tswapcat) — tswapcat","text":"trial-swap (\"tswap\") algorithm fixed–fixed randomization repeatedly attempts random 2×2 swaps valid one found iteration, reducing number wasted draws compared simple swap. tswapcat() extends logic categorical matrices.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/tswapcat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Trial-swap categorical randomization (tswapcat) — tswapcat","text":"","code":"tswapcat(x, n_iter = 1000L, output = c(\"category\", \"index\"), seed = NULL)"},{"path":"https://matthewkling.github.io/nullcat/reference/tswapcat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Trial-swap categorical randomization (tswapcat) — tswapcat","text":"x matrix categorical data, encoded integers. Values represent category stratum membership cell. n_iter Number iterations. Default 1000. Larger values yield thorough mixing. Ignored non-sequential methods. Minimum burn-times can estimated suggest_n_iter. output Character indicating type result return: \"category\" (default) returns randomized matrix \"index\" returns index matrix describing original        entries moved. seed Integer used seed random number generator, reproducibility.","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/tswapcat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Trial-swap categorical randomization (tswapcat) — tswapcat","text":"matrix dimensions x, either randomized   categorical values (output = \"category\") integer index   matrix describing permutation entries (output = \"index\").","code":""},{"path":"https://matthewkling.github.io/nullcat/reference/tswapcat.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Trial-swap categorical randomization (tswapcat) — tswapcat","text":"Gotelli, N. J. (2000). Null model analysis species co-occurrence patterns. *Ecology*, 81(9), 2606–2621. Miklós, . & Podani, J. (2004). Randomization presence–absence matrices: comments new algorithms. *Ecology*, 85(1), 86–92. Gotelli, N. J. & Entsminger, G. L. (2003). *EcoSim: Null models software ecology* (Version 7.0). Acquired Intelligence Inc. & Kesey-Bear, Jericho (VT).","code":""}]
