% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/curvecat.R
\name{curvecat}
\alias{curvecat}
\title{Categorical curveball randomization (curvecat)}
\usage{
curvecat(x, n_iter = 1000L, output = "category", swaps = "auto", seed = NULL)
}
\arguments{
\item{x}{A matrix of categorical data, encoded as integers.
Values should represent category or stratum membership for each cell.}

\item{n_iter}{Number of iterations. Default is 1000. Larger values yield
more thorough mixing. Ignored for non-sequential methods. Minimum
burn-in times can be estimated with \code{suggest_n_iter()}.}

\item{output}{Character indicating type of result to return:
\itemize{
\item \code{"category"} (default) returns randomized matrix
\item \code{"index"} returns an index matrix describing where original
entries (a.k.a. "tokens") moved. Useful mainly for testing, and for
applications like \code{quantize()} that care about token tracking
in addition to generic integer categories.
}}

\item{swaps}{Character string controlling the direction of token movement.
Only used when method is \code{"curvecat"}, \code{"swapcat"}, or \code{"tswapcat"}.
Affects the result only when \code{output = "index"}, otherwise it only affects
computation speed. Options include:
\itemize{
\item \code{"vertical"}: Tokens move between rows (stay within columns).
\item "\verb{horizontal"}: Tokens move between columns (stay within rows).
\item \code{"alternating"}: Tokens move in both dimensions, alternating between
vertical and horizontal swaps. Provides full 2D mixing without preserving
either row or column token sets.
\item \code{"auto"} (default): For \code{output = "category"},
automatically selects the fastest option based on matrix dimensions. For
\code{output = "index"}, defaults to \code{"alternating"} for full mixing.
}}

\item{seed}{Integer used to seed random number generator, for reproducibility.}
}
\value{
A matrix of the same dimensions as \code{x}, either randomized
categorical values (when \code{output = "category"}) or an integer index
matrix describing the permutation of entries (when \code{output = "index"}).
}
\description{
Categorical generalization of the binary curveball algorithm
(Strona et al.) to matrices of categorical data. This function
is a convenience wrapper around \code{\link[=nullcat]{nullcat()}} with
\code{method = "curvecat"}.
}
\details{
The curvecat algorithm randomizes a categorical matrix while keeping
the category multisets of each row and column fixed. In other words,
the permuted matrix has the same set of integer values in every row
and every column as the original matrix, but they are permuted. It
operates on pairs of rows at a time, grouping differing entries by
unordered category pairs and redistributing the orientation of those
pairs while preservingn the multiset of categories within each row.
When there are only two categories, \code{curvecat()} reduces to the
behavior of the original binary curveball algorithm applied to a 0/1
matrix.
}
\examples{
# Create a categorical matrix
set.seed(123)
x <- matrix(sample(1:4, 100, replace = TRUE), nrow = 10)

# Randomize preserving row and column category multisets
x_rand <- curvecat(x, n_iter = 1000)

# Verify margins are preserved
all.equal(sort(x[1, ]), sort(x_rand[1, ])) # row multisets preserved
all.equal(sort(x[, 1]), sort(x_rand[, 1])) # column multisets preserved

# Use with a seed for reproducibility
x_rand1 <- curvecat(x, n_iter = 1000, seed = 42)
x_rand2 <- curvecat(x, n_iter = 1000, seed = 42)
identical(x_rand1, x_rand2)

}
\references{
Strona, G., Nappo, D., Boccacci, F., Fattorini, S., & San-Miguel-Ayanz, J.
(2014). A fast and unbiased procedure to randomize ecological binary
matrices with fixed row and column totals. \emph{Nature Communications}, 5,
4114.
}
\seealso{
\code{\link[=nullcat]{nullcat()}}, \code{\link[=nullcat_methods]{nullcat_methods()}}
}
